version: 2

sources:
  - name: fhir
    schema: fhiropt
    tables:
      - name: Patient
      - name: Observation
      - name: Condition
      - name: Procedure
      - name: AllergyIntolerance
      - name: Encounter


models:
  - name: summary
    tests:
      - row_count_equals:
          target: "{{ source('fhir', 'Patient') }}"
  - name: by_condition
    tests:
      - row_count_less_or_equals:
          target: "{{ source('fhir', 'Patient') }}"
  - name: by_allergy
    tests:
      - row_count_less_or_equals:
          target: "{{ source('fhir', 'Patient') }}"
  - name: by_encounter
    tests:
      - row_count_less_or_equals:
          target: "{{ source('fhir', 'Patient') }}"
  - name: by_procedure
    tests:
      - row_count_less_or_equals:
          target: "{{ source('fhir', 'Patient') }}"

# exposures:
#   - name: mlready
#     type: ml
#     depends_on:
#       - ref('summary')
#     owner:
#       name: CaretDev
#       email: info@caretdev.com
